# Zavod Discord Bot

Бот для расчёта стоимости крафта в игре **EVE Echoes**. Данные рецептов и цен
хранятся в SQLite базе `zavod.db`.

## Требования

- Python 3.11+
- Discord токен (создаётся в [портале разработчика Discord](https://discord.com/developers/applications))

## Установка

```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

Создайте файл базы данных (бот сделает это автоматически при первом запуске)
и установите переменную окружения `DISCORD_TOKEN`:

```bash
export DISCORD_TOKEN=ВАШ_ТОКЕН
```

## Запуск

```bash
python bot.py
```

## Команды

- `!add_recipe <название> [выход_количество]` – добавить или обновить рецепт.
  Таблицу компонентов (пример ниже) можно вставить в сообщение или прикрепить
  текстовый файл.
- `!price <название> [эффективность]` – рассчитать стоимость рецепта. Если
  эффективность не указана, берётся глобальное значение.
- `!resource_price <название>` – показать последнюю сохранённую цену ресурса.
- `!set_efficiency <значение>` – установить глобальную эффективность (требуются
  права администратора).
- `!global_efficiency` – показать текущую глобальную эффективность.
- `!update_bot` – обновить код бота из GitHub репозитория (требуются права
  администратора).

### Формат рецепта

```
ID    Название         Количество    Оценка стоимости
1     Sheen Compound   14764         6269680.24
...
```

Стоимость ресурса рассчитывается как `Оценка стоимости / Количество` и
сохраняется глобально. Если для ресурса существует другой рецепт, его стоимость
будет вычислена из составных компонентов.

### Эффективность

Эффективность всегда добавляется как 100 %. При расчёте цены можно указать
другое значение – количество компонентов будет скорректировано по формуле
`Количество * (100 / эффективность)`.
